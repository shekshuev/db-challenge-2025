## Задание 1. Шифровальный модуль "Цезарь"

Рядовой Селектов, известный в подразделении не только любовью к SQL, но и паранойей, наконец-то нашёл себе идеальное средство самозащиты — шифр Цезаря.

> "Если даже Рим пал от варваров, то и мои запросы могут попасть в чужие руки"

\- заявил он и стал шифровать всё: от `SELECT`’ов до любовных записок прапорщику Надежде Дроповой.

Реализуй функцию `caesar(text, shift)` на SQL, которая сдвигает каждый символ ASCII на заданное значение. Она понадобится тебе, чтобы расшифровывать все последующие задания. Обрати внимание на встроеные функции `chr` и `ascii` в PostgreSQL.

**Важные замечания по реализации:**

- Функции `ascii()` и `chr()` в PostgreSQL работают с кодами символов.
- Диапазон кодов для `A..Z` - `65..90`, для `a..z` - `97..122`, для `0..9` - `48..57`.
- С точки зрения математики операция `-1 % 26` дает результат `25`. В SQL `-1`

  ```sql
  SELECT -1 % 26; -- -1
  ```

  Чтобы корректно работать с отрицательным сдвигом, следует вычислять модуль по формуле:

  ```sql
  ((code - 32 + shift) % 95 + 95) % 95
  ```

  Это гарантирует, что результат всегда останется в диапазоне `0..94`, даже при отрицательном `shift`.

- Для букв сдвиг `26`, для цифр `10`.

Проверка:

```sql
select caesar('Data bases', 5) -- Ifyf%gfxjx
select caesar('Ifyf%gfxjx', -5) -- Data bases
```

## Задание 2. Василий Петрович и таблицы

Полковник Василий Петрович Транзакциев, командир учебной базы данных, в попытке автоматизировать распределение пайков между ротами, создал 10 таблиц.

На третий день распределения пайков он заметил: две таблицы почти идентичны, но с одним отличием — у одной из колонок другое имя, хотя тип и позиция те же.

Твоё задание: найти эти две таблицы в схеме `challenge`, а также их колонки.

Пример результата:

| table_1     | table_1_column | table_2     | table_2_column |
| ----------- | -------------- | ----------- | -------------- |
| table_12345 | col_23456      | table_34567 | col_45678      |

Имя каждой таблицы - строка вида `table_<случайное_число>`, например `table_12345`. Сумма чисел по модулю 128 из найденных двух таблиц является ключом к следующей задаче (в зашифрованном виде через шифр из задания 1). Для примера выше ключ будет:

```sql
select (12345 + 34567) % 128 -- 64
```

## Задание 3. Инцидент в бухгалтерии

В учебной базе числилась Галина Семеновна Коммитова, главбух, которая стала работать на этом месте еще до появления SQL-86, за что получила признание, почет и уважение сослуживцев. А молодые курсанты за ее доброту называют ее просто - баба Галя из бухгалтерии. Она не терпит бардака, особенно в отчётности по спецпайкам. Баба Галя вручную вбивала данные в одну из таблиц Василия Петровича.

Но в момент записи очередной строки, в базе данных отключилось питание — как раз когда она отвлеклась, чтобы угостить зашедшего поздороваться курсанта пирожком с повидлом.

Последнее, что она помнила: одно из значений точно совпадало с названием колонки.

Найди эту строку и вытащи имя колонки, одно из значений которой совпало с ее именем. Таблица, в которой находится эта колонка - `wdeoh_97022` (зашифровано шифром Цезаря с ключом из предыдущей задачи). Число из значения этой колонки, взятое по модулю 128, является ключом для следующего задания.

## Задание 4. Самоподготовка и "Угадай число"

На следующий день после напряжённого наряда рядовой Селектов захотел отдохнуть. И как настоящий военный программист, он написал игру "Угадай число" прямо в SQL. Но код он зашифровал и не отдает никому.

Тебе нужно превзойти Селектова, написав многопользовательскую игру "Угадай число". Реализуй следующую логику:

- В процессе угадывания числа участвуют строго два пользователя
- Для участия создается "комната" на двух человек
- Если пользователь хочет поиграть, то система ищет комнату с одним игроком, и:
  - если находит, то текущий игрок присоединятеся и игра начинается
  - если не находит, то создает новую комнату, помещает туда игрока и он ждет, пока кто-то еще присоединится к нему.
- В момент начала игры (когда в комнате появилось два игрока) база генерирует случайное число от 1 до 100000.
- Каждый игрок делает попытки ответить. База отвечает:
  - "Меньше" — если загаданное число меньше;
  - "Больше" — если больше;
  - "Угадал!" — если попал.
- Каждыя попытка логгируется
- Когда пользователь угадал, нужно показать ему, с какой попытки он это сделал, и закрыть комнату.
- В игре предусмотрет чит-код `735` (зашифрован ключом из предыдущего задания). При его вводе пользователь автоматически признается победителем.
